<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financeiro Cloud - Henrique</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
        :root { --purple: #6c63ff; --green: #2ecc71; --orange: #f39c12; --bg: #f0f2f5; --text: #333; }
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body { background-color: var(--bg); font-family: 'Poppins', sans-serif; color: var(--text); padding: 20px; }
        
        /* LOGIN */
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 10000; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .login-box { background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; width: 90%; max-width: 400px; }
        .login-box input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .btn-login { width: 100%; padding: 12px; background: var(--purple); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .error-msg { color: #e74c3c; font-size: 14px; margin-bottom: 15px; display: none; }
        #app-container { display: none; }

        /* LAYOUT */
        .container { width: 100%; max-width: 1000px; margin: 0 auto; }
        header { display: flex; flex-direction: column; align-items: center; margin-bottom: 25px; gap: 10px; }
        
        /* BARRA DE FILTROS */
        .filters-bar { 
            background: #fff; 
            padding: 10px 20px; 
            border-radius: 30px; 
            border: 2px solid var(--purple); 
            display: flex; 
            flex-wrap: wrap;
            align-items: center; 
            justify-content: center;
            gap: 15px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .filter-group { display: flex; align-items: center; gap: 5px; }
        .filter-group label { font-size: 12px; font-weight: 600; color: #666; }
        .filter-group select, .filter-group input { border: 1px solid #eee; background: #f9f9f9; padding: 5px 10px; border-radius: 15px; font-size: 14px; cursor: pointer; color: #333; font-weight: 500;}
        .filter-group input { border: none; background: transparent; font-weight: bold; font-size: 15px; }

        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); text-align: center; }
        .money { font-size: 28px; font-weight: bold; margin: 10px 0; }
        .balance-card .money { color: var(--green); }
        .invoice-card .money { color: var(--orange); }
        
        .main-content { display: flex; flex-wrap: wrap; gap: 20px; }
        .column { flex: 1; min-width: 320px; display: flex; flex-direction: column; gap: 20px; }
        .box-clean { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .box-clean h3 { border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 15px; color: #555; }
        
        .form-control { margin-bottom: 15px; }
        .form-control label { display: block; margin-bottom: 5px; font-size: 12px; font-weight: 600; color: #666; }
        input, select, textarea { border: 1px solid #ddd; border-radius: 8px; padding: 12px; width: 100%; font-family: inherit; }
        .row-inputs { display: flex; gap: 10px; }
        .half { flex: 1; }
        
        .btn-icon { background: var(--purple); color: #fff; border: none; width: 50px; border-radius: 8px; cursor: pointer; font-size: 18px; }
        .btn-save { width: 100%; background: var(--purple); color: #fff; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
        
        /* LISTAS */
        .list li { background: #f9f9f9; padding: 12px; margin-bottom: 8px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid #ccc; }
        .list li.income { border-left-color: var(--green); }
        .list li.expense-debit { border-left-color: #555; }
        .list li.expense-credit { border-left-color: var(--orange); }
        
        .tag { background: #e3f2fd; color: #1565c0; padding: 5px 12px; border-radius: 20px; font-size: 12px; display: flex; align-items: center; gap: 5px; cursor: pointer; margin-right: 5px; margin-bottom: 5px;}
        .tags-container { display: flex; flex-wrap: wrap; }
        .tag-delete { color: #e74c3c; margin-left: 5px; font-weight: bold; }

        .bank-summary-item { flex-direction: column; align-items: flex-start; padding: 0; overflow: hidden; background: #fff; border-left: none; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 10px; }
        .bank-header { display: flex; justify-content: space-between; width: 100%; padding: 10px 15px; color: #fff; font-weight: bold; }
        .bank-people-list { width: 100%; padding: 10px 15px; font-size: 13px; color: #555; }
        .bank-person-row { display: flex; justify-content: space-between; border-bottom: 1px dashed #eee; padding: 4px 0; }
        
        .radio-group { display: flex; gap: 10px; }
        .radio-group input { display: none; }
        .radio-label { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 8px; text-align: center; cursor: pointer; }
        input:checked + .radio-label { background-color: #f3e5f5; border-color: var(--purple); color: var(--purple); font-weight: 600; }
        
        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); display: flex; justify-content: center; align-items: center; z-index: 9999; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--purple); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h2><i class="fas fa-lock"></i> Acesso Restrito</h2>
            <p style="margin-bottom: 20px; color: #666;">Entre com sua conta criada no Firebase</p>
            <div id="login-error" class="error-msg">Email ou senha incorretos!</div>
            <input type="email" id="email" placeholder="Seu E-mail">
            <input type="password" id="password" placeholder="Sua Senha">
            <button class="btn-login" id="btn-login">Entrar no Sistema</button>
        </div>
    </div>

    <div id="loading-overlay" style="display: none;"><div class="spinner"></div></div>

    <div class="container" id="app-container">
        <header>
            <div style="width:100%; display:flex; justify-content:flex-end;">
                <button id="btn-logout" style="background:none; border:none; color:#e74c3c; cursor:pointer; font-weight:bold;">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
            <h1>Painel Financeiro Cloud <i class="fas fa-cloud" style="color:#6c63ff;"></i></h1>
            
            <div class="filters-bar">
                <div class="filter-group">
                    <i class="fas fa-calendar-alt" style="color:var(--purple)"></i>
                    <input type="month" id="month-filter" onchange="updateScreen()">
                </div>
                
                <div class="filter-group">
                    <label>Pessoa:</label>
                    <select id="filter-user" onchange="updateScreen()">
                        <option value="">Todas</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>Banco:</label>
                    <select id="filter-bank" onchange="updateScreen()">
                        <option value="">Todos</option>
                    </select>
                </div>
            </div>

            <small style="color:#28a745; font-size:12px; margin-top:5px;" id="status-indicator">● Online e Seguro</small>
        </header>

        <div class="dashboard-grid">
            <div class="card balance-card">
                <h3>Saldo (Débito)</h3>
                <p id="wallet-balance" class="money">R$ 0.00</p>
                <small>Acumulado (Filtrado)</small>
            </div>
            <div class="card invoice-card">
                <h3>Fatura Mês</h3>
                <p id="invoice-total" class="money">R$ 0.00</p>
                <small>Referência Selecionada</small>
            </div>
        </div>

        <div class="main-content">
            <div class="column">
                <div class="box-clean">
                    <h3>Pessoas</h3>
                    <div class="tags-container" id="users-list-tags"></div>
                    <div class="input-group-row">
                        <input type="text" id="new-user-name" placeholder="Adicionar Nome">
                        <button onclick="addUser()" class="btn-icon"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
                <div class="box-clean">
                    <h3>Bancos</h3>
                    <div class="tags-container" id="banks-list"></div>
                    <div class="input-group-row">
                        <input type="text" id="new-bank-name" placeholder="Novo Banco">
                        <button onclick="addBank()" class="btn-icon"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
                <div class="box-clean">
                    <h3 id="form-title">Movimentação</h3>
                    <form id="transaction-form">
                        <input type="hidden" id="edit-transaction-id">
                        <div class="form-control"><label>Descrição</label><input type="text" id="desc" placeholder="Ex: Mercado" required></div>
                        <div class="form-control"><label>Observação</label><textarea id="obs" rows="2"></textarea></div>
                        <div class="row-inputs">
                            <div class="form-control half"><label>Valor (R$)</label><input type="text" id="amount" placeholder="0,00" required></div>
                            <div class="form-control half"><label>Data</label><input type="date" id="trans-date" required></div>
                        </div>
                        <div class="row-inputs">
                            <div class="form-control half"><label>Banco</label><select id="bank-select"></select></div>
                            <div class="form-control half"><label>Tipo</label><select id="trans-type"><option value="expense">Saída (-)</option><option value="income">Entrada (+)</option></select></div>
                        </div>
                        <div class="row-inputs">
                            <div class="form-control half"><label>Parcelas</label><input type="number" id="installments" value="1" min="1" max="60"></div>
                            <div class="form-control half"><label>Quem?</label><select id="user-select" onchange="checkUserMethod()"></select></div>
                        </div>
                        <div class="form-control">
                            <label>Pagamento</label>
                            <div class="radio-group">
                                <input type="radio" id="method-debit" name="method" value="debit" checked><label for="method-debit" class="radio-label">Débito</label>
                                <input type="radio" id="method-credit" name="method" value="credit"><label for="method-credit" class="radio-label">Cartão</label>
                            </div>
                        </div>
                        <div style="display:flex;gap:10px;">
                            <button type="submit" id="btn-submit" class="btn-save">Salvar</button>
                            <button type="button" id="btn-cancel" class="btn-save" style="background:#95a5a6;display:none;" onclick="cancelEdit()">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="column">
                <div class="box-clean"><h3>Fatura (Por Banco)</h3><ul id="invoice-split-list" class="list"></ul></div>
                <div class="box-clean"><h3>Extrato Mês</h3><ul id="transactions-list" class="list"></ul></div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
          apiKey: "AIzaSyBaZMJ1wmsTXEQjmgiDtceUvzVHsfSslg0",
          authDomain: "financeiro-luique.firebaseapp.com",
          projectId: "financeiro-luique",
          storageBucket: "financeiro-luique.firebasestorage.app",
          messagingSenderId: "552706446904",
          appId: "1:552706446904:web:4fcc0bc31811b82e4938cd",
          measurementId: "G-RN7JXL13D5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);
        const dbRef = ref(db, 'dados_henrique');

        // --- UI ELEMENTS ---
        const elLoader = document.getElementById('loading-overlay');
        const loginScreen = document.getElementById('login-screen');
        const appContainer = document.getElementById('app-container');
        
        // Filtros
        const elMonthFilter = document.getElementById('month-filter');
        const elFilterUser = document.getElementById('filter-user');
        const elFilterBank = document.getElementById('filter-bank');

        // Formulário
        const elTransDate = document.getElementById('trans-date');
        const elUserSelect = document.getElementById('user-select');
        const elBankSelect = document.getElementById('bank-select');
        const elDesc = document.getElementById('desc');
        const elObs = document.getElementById('obs');
        const elAmount = document.getElementById('amount');
        const elInstallments = document.getElementById('installments');
        const elEditId = document.getElementById('edit-transaction-id');
        const elBtnSubmit = document.getElementById('btn-submit');
        const elBtnCancel = document.getElementById('btn-cancel');

        let users = [], transactions = [], banks = [];
        const bankColors = { 'Nubank': '#820ad1', 'Bradesco': '#cc092f', 'Itaú Uniclass': '#ec7000', 'Mercado Pago': '#009ee3', 'Pão de Açúcar': '#005835', 'Azul Platinum': '#0f2660', 'Azul Gold': '#1e40af', 'default': '#555555' };
        
        const bankDueDates = {
            'Bradesco': '08', 'Mercado Pago': '08', 'Itaú Uniclass': '10',
            'Nubank': '09', 'Azul Platinum': '15', 'Azul Gold': '17', 'Pão de Açúcar': '18'
        };

        // --- AUTH ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                loginScreen.style.display = 'none';
                appContainer.style.display = 'block';
                elLoader.style.display = 'flex';
                carregarDados();
            } else {
                loginScreen.style.display = 'flex';
                appContainer.style.display = 'none';
            }
        });

        document.getElementById('btn-login').addEventListener('click', () => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            signInWithEmailAndPassword(auth, email, pass).catch(err => {
                document.getElementById('login-error').style.display = 'block';
                document.getElementById('login-error').innerText = "Erro: " + err.message;
            });
        });

        document.getElementById('btn-logout').addEventListener('click', () => { signOut(auth); location.reload(); });

        // --- DATA ---
        function carregarDados() {
            onValue(dbRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    transactions = data.transactions || [];
                    users = data.users || [];
                    banks = data.banks || [];
                } else {
                    users = ['Henrique'];
                    banks = Object.keys(bankColors).filter(b => b !== 'default');
                    transactions = [];
                }
                elLoader.style.display = 'none';
                initUI();
            });
        }

        function saveData() {
            set(dbRef, { users, banks, transactions }).catch(err => alert("Erro ao salvar: " + err.message));
        }

        // --- FUNÇÃO CORRIGIDA DE PARSE DE VALOR (1.000,00 -> 1000.00) ---
        function parseValor(valorStr) {
            let limpo = valorStr.replace(/\./g, '').replace(',', '.');
            return parseFloat(limpo);
        }

        // --- UI ---
        function initUI() {
            if (!users.includes('Henrique')) users.unshift('Henrique');
            if (!elMonthFilter.value) {
                const now = new Date();
                elMonthFilter.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;
                elTransDate.value = now.toISOString().split('T')[0];
            }
            updateDropdowns();
            updateScreen();
        }

        // --- SALVAR / EDITAR ---
        document.getElementById('transaction-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const rawAmount = elAmount.value;
            const totalAmount = parseValor(rawAmount); 
            const dateInput = elTransDate.value;
            const installments = parseInt(elInstallments.value) || 1;

            if (isNaN(totalAmount) || totalAmount <= 0) { alert("Valor inválido"); return; }
            if (!dateInput) { alert("Selecione a data"); return; }

            const baseData = {
                desc: elDesc.value,
                obs: elObs.value,
                type: document.getElementById('trans-type').value,
                user: elUserSelect.value,
                bank: elBankSelect.value,
                method: document.getElementById('method-credit').checked ? 'credit' : 'debit'
            };

            if (elEditId.value) {
                // MODO EDIÇÃO
                if (installments > 1) {
                    if(confirm("Você alterou para " + installments + " parcelas. Isso irá recriar os lançamentos. Confirmar?")) {
                        transactions = transactions.filter(t => t.id != elEditId.value);
                        criarParcelas(baseData, totalAmount, installments, dateInput);
                    } else {
                        return;
                    }
                } else {
                    const idx = transactions.findIndex(t => t.id == elEditId.value);
                    if (idx !== -1) {
                        const parts = dateInput.split('-');
                        const displayDate = `${parts[2]}/${parts[1]}/${parts[0]}`;
                        
                        transactions[idx] = { 
                            ...transactions[idx], 
                            ...baseData, 
                            amount: totalAmount, 
                            date: dateInput, 
                            displayDate: displayDate 
                        };
                    }
                }
                cancelEdit();
            } else {
                // MODO CRIAÇÃO
                criarParcelas(baseData, totalAmount, installments, dateInput);
                document.getElementById('transaction-form').reset();
                elInstallments.value = 1;
            }
            saveData();
        });

        function criarParcelas(data, total, qtd, startDateStr) {
            const valorParcela = total / qtd;
            const parts = startDateStr.split('-');
            const year = parseInt(parts[0]);
            const month = parseInt(parts[1]) - 1;
            const day = parseInt(parts[2]);

            for (let i = 0; i < qtd; i++) {
                const dt = new Date(year, month + i, day);
                const isoDate = dt.toISOString().split('T')[0];
                const ptDate = dt.toLocaleDateString('pt-BR');
                
                const descText = qtd > 1 ? `${data.desc} (${i+1}/${qtd})` : data.desc;

                transactions.push({
                    id: Date.now() + i,
                    ...data,
                    desc: descText,
                    amount: valorParcela,
                    date: isoDate,
                    displayDate: ptDate
                });
            }
        }

        window.updateScreen = function() {
            const list = document.getElementById('transactions-list'); list.innerHTML = '';
            const splitList = document.getElementById('invoice-split-list'); splitList.innerHTML = '';
            
            let wallet = 0, invoice = 0, bankConsolidation = {};
            const selMonth = elMonthFilter.value;
            const selUser = elFilterUser.value; // Filtro Pessoa
            const selBank = elFilterBank.value; // Filtro Banco

            // Filtro Principal (AND Logic)
            const filtered = transactions
                .filter(t => {
                    const matchMonth = t.date.startsWith(selMonth);
                    const matchUser = selUser === "" || t.user === selUser;
                    const matchBank = selBank === "" || t.bank === selBank;
                    return matchMonth && matchUser && matchBank;
                })
                .sort((a,b) => a.date.localeCompare(b.date));

            // Renderização e Cálculos com base nos FILTRADOS
            filtered.forEach(t => {
                // Cálculo de Saldo
                if (t.type === 'income') wallet += t.amount;
                if (t.type === 'expense' && t.method === 'debit') wallet -= t.amount;

                // Renderiza Lista
                const li = document.createElement('li');
                li.className = t.type === 'income' ? 'income' : (t.method === 'credit' ? 'expense-credit' : 'expense-debit');
                const sign = t.type === 'expense' ? '-' : '+';
                const dateShow = t.displayDate || t.date.split('-').reverse().join('/');
                const descShow = t.desc || 'Sem descrição';

                li.innerHTML = `
                    <div style="flex:1">
                        <strong style="font-size:14px; color:#333; display:block;">${descShow}</strong>
                        <small style="color:#666">${t.user} | ${t.bank || '-'} | ${dateShow}</small>
                        ${t.obs ? `<br><small style="color:#888; font-style:italic">${t.obs}</small>` : ''}
                    </div>
                    <div style="display:flex;align-items:center;gap:10px;">
                        <strong style="white-space:nowrap;">${sign} R$ ${t.amount.toFixed(2)}</strong>
                        <div>
                            <button onclick="editTrans(${t.id})" style="border:none;background:none;cursor:pointer;color:#2980b9"><i class="fas fa-pen"></i></button>
                            <button onclick="removeTrans(${t.id})" style="border:none;background:none;cursor:pointer;color:#c0392b"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>`;
                list.prepend(li);

                // Consolida Fatura (Crédito)
                if (t.type === 'expense' && t.method === 'credit') {
                    invoice += t.amount;
                    const b = t.bank || 'Outros';
                    if (!bankConsolidation[b]) bankConsolidation[b] = { total: 0, users: {} };
                    bankConsolidation[b].total += t.amount;
                    bankConsolidation[b].users[t.user] = (bankConsolidation[b].users[t.user] || 0) + t.amount;
                }
            });

            document.getElementById('wallet-balance').innerText = `R$ ${wallet.toFixed(2)}`;
            document.getElementById('invoice-total').innerText = `R$ ${invoice.toFixed(2)}`;

            for (const [bName, data] of Object.entries(bankConsolidation)) {
                if (data.total > 0) {
                    const li = document.createElement('li'); li.className = 'bank-summary-item';
                    
                    const dueDate = bankDueDates[bName] ? ` - Dia ${bankDueDates[bName]}` : '';
                    
                    let html = `<div class="bank-header" style="background:${bankColors[bName]||'#555'}"><span>${bName}${dueDate}</span><span>R$ ${data.total.toFixed(2)}</span></div><div class="bank-people-list">`;
                    for (const [p, v] of Object.entries(data.users)) html += `<div class="bank-person-row"><span>${p}</span><strong>R$ ${v.toFixed(2)}</strong></div>`;
                    li.innerHTML = html + '</div>';
                    splitList.appendChild(li);
                }
            }
        };

        window.editTrans = function(id) {
            const t = transactions.find(x => x.id === id); if(!t) return;
            elEditId.value = t.id;
            elDesc.value = t.desc;
            elObs.value = t.obs || '';
            elAmount.value = t.amount.toFixed(2).replace('.', ',');
            elTransDate.value = t.date;
            elUserSelect.value = t.user;
            elBankSelect.value = t.bank;
            document.getElementById('trans-type').value = t.type;
            document.getElementById(t.method === 'credit' ? 'method-credit' : 'method-debit').checked = true;
            
            document.getElementById('form-title').innerText = "Editar Lançamento";
            elBtnSubmit.innerText = "Atualizar"; 
            elBtnCancel.style.display = "block";
            
            elInstallments.value = 1; 
            elInstallments.disabled = false; 
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.cancelEdit = function() {
            elEditId.value = ''; 
            document.getElementById('transaction-form').reset();
            document.getElementById('form-title').innerText = "Movimentação"; 
            elBtnSubmit.innerText = "Salvar"; 
            elBtnCancel.style.display = "none";
            elInstallments.value = 1;
            elInstallments.disabled = false;
        };

        window.checkUserMethod = function() { if(elUserSelect.value !== 'Henrique') document.getElementById('method-credit').checked = true; };
        window.addUser = function() { const n = document.getElementById('new-user-name').value.trim(); if(n && !users.includes(n)) { users.push(n); saveData(); updateDropdowns(); } };
        window.removeUser = function(n) { if(n!=='Henrique' && confirm('Excluir?')) { users=users.filter(u=>u!==n); saveData(); updateDropdowns(); } };
        window.addBank = function() { const n = document.getElementById('new-bank-name').value.trim(); if(n && !banks.includes(n)) { banks.push(n); saveData(); updateDropdowns(); } };
        window.removeBank = function(n) { if(confirm('Excluir?')) { banks=banks.filter(b=>b!==n); saveData(); updateDropdowns(); } };
        window.removeTrans = function(id) { if(confirm('Apagar lançamento?')) { transactions=transactions.filter(t=>t.id!==id); saveData(); updateScreen(); } };

        function updateDropdowns() {
            // Atualiza Selects do Formulário
            elUserSelect.innerHTML = ''; 
            document.getElementById('users-list-tags').innerHTML = '';
            
            // Atualiza Selects do FILTRO
            elFilterUser.innerHTML = '<option value="">Todas</option>';
            elFilterBank.innerHTML = '<option value="">Todos</option>';

            users.forEach(u => {
                elUserSelect.add(new Option(u, u));
                elFilterUser.add(new Option(u, u)); // Add no filtro

                const div = document.createElement('div'); div.className='tag'; div.innerHTML=`<span>${u}</span><span class="tag-delete" onclick="removeUser('${u}')">&times;</span>`;
                document.getElementById('users-list-tags').appendChild(div);
            });

            elBankSelect.innerHTML = ''; 
            document.getElementById('banks-list').innerHTML = '';
            
            banks.forEach(b => {
                elBankSelect.add(new Option(b, b));
                elFilterBank.add(new Option(b, b)); // Add no filtro

                const div = document.createElement('div'); div.className='tag'; div.innerHTML=`<span>${b}</span><span class="tag-delete" onclick="removeBank('${b}')">&times;</span>`;
                document.getElementById('banks-list').appendChild(div);
            });
        }
    </script>
</body>
</html>
